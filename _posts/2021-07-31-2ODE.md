---
title: "[MATH/공수] 2계 선형상미분방정식 푸는 법"
excerpt: "왕초보 공업수학강의 2편"
last_modified_at: 2021-07-31T15:01+09:00
categories: "math"
tag: "engineering mathematics"
toc: true
toc_sticky: true
author_profile: false
---

# 2계 선형상미분방정식

이전 포스트에서도 말했다시피 선형성을 가진다는건 곧 중첩의 원리가 적용될 수 있다는 것이고,  
2계 **선형**제차상미분방정식의 해공간은 두 기저해들의 span임을 꼭꼭 기억하고 이해해야 한다.  
나중에 고차 미분방정식 포스트에서 다시 한 번 설명하겠다.  

대수적으로는 

$$y'' + p(x)y' + q(x)y = r(x)$$  

꼴이고 우변이 0이냐 아니냐에 따라 각각 제차, 비제차라고 한다.  

유형이 몇 가지 있는데,  
1. 계수내림법
2. 상수계수인 경우(제차 2계 선형상미분방정식)
3. 오일러-코시(제차 2계 선형상미분방정식)
4. 상수계수인 경우, 미정계수법(비제차 2계 선형상미분방정식)
5. 매개변수변환법(비제차 2계 선형상미분방정식)

이 다섯 가지가 있다.  

# 계수내림법

이미 답을 하나 알고 있다는 걸 전제로 한다.  

2차 미분방정식이기 때문에 해공간을 이루는 기저가 두 개 존재하는데(행렬로 나타내었을 때 연립방정식임) 이 둘은 반드시 linearly independent하다. 비례관계가 아님을 식으로 표현하면 $$y_2 = y_{1}u$$ 이고 이걸 위의 식에 대입하면  

$$y_2 = y_{1}u = y_{1}\int_{}{}\frac{1}{y_1^2}e^{-\int_{}{}pdx}dx$$  

이다. 솔직히 다른거 외울것도 많은데 이 공식까지 외우기는 귀찮잖아? 그러면 $$y_2 = uy_1$$ 이것만 기억하고 직접 대입해서 구하거나 시험치기 직전에 외우면 된다.  

# 제차 2계 선형상미분방정식

$$y'' + p(x)y' + q(x)y = 0$$  

제차인지 아닌지가 꽤 중요한데, 기저들의 linear combination으로 표현하려면 중간에 행렬식을 구하는 과정 또는 characteristic equation을 푸는 과정을 거쳐야 한다. 그 때, r(x)가 해당 구간에서 모두 0이 아니라면 고윳값 또는 특성값을 구할 수가 없다. 제차의 경우, 구할 수 있기 때문에 크게 2가지의 풀이법 안에서 해결된다.

## 상수계수를 갖는 제차 선형상미분방정식

여기서 내가 그토록 외쳤던 선형성을 살짝 살펴볼 수 있다.  
상수계수가 a와 b인 $$y'' + ay' + by = 0$$  

위 식을 $$y'$$이라는 벡터와 $$y$$라는 벡터의 선형변환이라고 생각해보자.  

$$\frac{d}{dx}\begin{bmatrix}y'\\y\end{bmatrix} = \begin{bmatrix}-a&-b\\1&0\end{bmatrix}\begin{bmatrix}y'\\y\end{bmatrix}$$  

선형변환에 해당하는 행렬을 A행렬이라고 하면,  
$$\vec{y'} = A\vec{y} = \lambda\vec{y}$$  
이고 A의 고유벡터는 해공간의 기저가 된다.  
중첩의 원리를 적용하여 기저의 linear combination으로 나타내면 위 식의 해는  
$$y = c_1e^{\lambda_1x} + c_2e^{\lambda_2x}$$  
이다.  

이때, 고윳값은  

$$\det(A - {\lambda}I) = \begin{vmatrix}-a-\lambda&-b\\1&-\lambda\end{vmatrix} = \lambda^2 + a\lambda + b = 0$$  

이다.  
한편으로, 선형제차미분방정식의 경우 전부 $$y' = Ay$$꼴로 정리되기 때문에 해의 기저가 규칙적으로 $$e^{\lambda x}$$ 형태를 가지게 된다. 그래서 일단 대입하고 정리하면  

$$(\lambda^2 + a\lambda + b)e^{\lambda x} = 0$$  

이 나오는데 이는 위에서 선형변환 행렬의 고윳값을 구하는 식과 동일하다.  
$$\lambda^2 + a\lambda + b$$ 을 특성방정식이라고 한다.  

특성방정식이든, 고윳값을 구하는 행렬식이든간에 결국 2차방정식으로 귀결되는데 이 때문에 세 가지 경우의 수가 생긴다.  

1. 두 개의 서로 다른 실근
2. 실이중근
3. 복소근

### 두 개의 서로 다른 실근

이 경우, 두 기저가 실수이기 때문에 두 기저의 linear combination인 $$y = c_1e^{\lambda_1x} + c_2e^{\lambda_2x}$$ 이다.  

### 실이중근

이 경우, 하나의 기저($$y_1=e^{-\frac{a}{2}x}$$)를 명확히 알고 있는 상태이므로 앞서 설명했던 계수내림법을 사용하면 된다.  
$$y_2 = uy_1$$를 미분방정식에 대입하고 정리하면, 가장 간단한 u는 x이다. 따라서,  
두 기저의 linear combination인  
$$y = (c_1 + c_2x)e^{-\frac{ax}{2}}$$  

### 복소근

2차방정식의 근의 공식을 이용하면  
$$\lambda = \frac{1}{2}(-a \pm \sqrt{a^2 - 4b})$$ 인데, 루트 안의 값이 음수일 때 복소근이 생긴다.  
이 경우, $$y = c_1e^{-\frac{a}{2}x + i\omega} + c_2e^{-\frac{a}{2}x - i\omega}, \omega = \sqrt{b -\frac{1}{4}a^2}$$ 이다.  
사실 여기서 끝내고 싶은데 오일러공식을 이용해서 깔끔하게 만들지 않으면 감점되는 걸 실제로 봤다.  
$$e^{-\frac{a}{2}x + i\omega} = e^{-\frac{a}{2}x}(\cos{\omega x} + i\sin{\omega x})$$  
$$e^{-\frac{a}{2}x - i\omega} = e^{-\frac{a}{2}x}(\cos{\omega x} - i\sin{\omega x})$$  
여기까지만 해도 감점당하지는 않지만 교수님이 별로 탐탁치 않게 여기셨다.  
이 두개의 기저를 얻을 수 있고, 기저를 서로 합하거나 상수배를 해도 기저이므로 아름답게 만들면  
$$y = e^{-\frac{ax}{2}}(A\cos{\omega x} + B\sin{\omega x}), \omega = \sqrt{b - \frac{1}{4}a^2$$ 로 나타낼 수 있다.  

#### 오일러 공식

당연하게도 군대갔다온 우리의 머릿속에는 오일러 공식대신 "오늘 할 작업을 내일로 미루면 내일 안 할 수도 있다"따위의 군대명언으로 가득차있다. 오일러 공식은 미적분이라는 과목에서 공부를 했었다고 전해져내려오는데  

$$e^{it}$$를 멕클로린 급수로 풀고 예쁘게 정리하면 삼각함수의 합으로 나온다는 건데 직접해봐도 좋고  

$$e^{it} = \cos{t} + i\sin{t}$$ 를 외워도 된다.  
이게...외우라고 하기 애매한 것이 이 자체로는 별로 공업수학과 관련이 없기는 한데 테일러 급수와 멕클로린 급수가 미분방정식을 푸는 방법의 기저에 있기 때문에 무조건 외우라고 할 수는 없다. 직접 한번 해봐야 한다. 귀찮더라도 공업수학 C학점 받기 싫으면 테일러 급수로 한번, 멕클로린 급수로 한번 전개해 보자.  

## Euler-Cauchy 방정식(제차)

$$x^2y'' + axy' + by = 0$$  
특징은 미분차수와 독립변수의 거듭제곱차수가 같다는 점이다.  

상수계수가 아닌 경우, 상당히 힘든데 그 중, 오일러-코시 방정식의 형태를 가지는 미분방정식은 쉽게 풀 수 있다.  
상수계수의 경우 기저를 $$e^{\lambda x}$$ 로 했지만 오일러-코시의 경우, $$x^m$$ 을 기저라고 가정하고 대입해서 구하면 나온다.  

마찬가지로 보조방정식이라고 불리는 2차 방정식이 나오는데 세 가지 경우를 나누어 적절히 구하면된다. 과정은 상수계수와 비슷하므로 생략.

# 비제차 2계 선형상미분방정식

$$y'' + p(x)y' + q(x)y = r(x)$$  

여기가 조금 어려운게, 특성방정식이나 보조방정식을 풀 수가 없다.  
그래서 제차와 비제차의 해의 관계를 통해 조금 쉽게 풀어볼 수 없을까 생각하게 된다.  

> 비제차의 두 개의 해의 차는 제차의 해가 된다.  

 비제차의 어떤 해 $$y^*,y_p$$에 대해 이것의 차가 제차의 해 $$Y$$가 된다고 하자.  
$$y^* = Y + y_p$$이고 이걸로 뭘 어떻게 하는지는 모르겠는데 이걸로 여러 석학들이 열심히 증명해보니  

열린구간 I에서 비제차 상미분방정식의 일반해는  

$$y(x) = y_h(x) + y_p(x)$$  

라고 한다. 제차의 일반해, 비제차의 특수해의 합이 비제차의 일반해가 된다는 것이다.  
이를 바탕으로 우리는 $$y_p$$를 찾는 법을 배워야 한다.  

## 미정계수법

그 중의 하나가 이 미정계수법이라고 하는 건데, 상수계수를 갖는 비제차 상미분방정식을 풀 때 쓴다.  
기본적으로 때려맞춰보자라는 개념인데, 주먹구구식으로 하는건 아니고 규칙이 있다.  

1. 미정계수를 갖는 그럴듯한 함수를 대입한다.  
2. 이미 구했던 제차의 해와 겹치면 x의 거듭제곱을 곱한다. 안겹칠 때까지  

![미정계수법](/assets/math/undeterminedCoefficient.png)

그럴듯한 함수라는 건 위의 이미지에서 찾으면 된다.  

## 매개변수변환에 의한 풀이

그렇지만 때려맞추지 못하는 경우도 있을테고 저 위의 방식은 너무 비효율적이다. 일반적인 풀이법이 필요하다.  
앞선 설명에서 우리는 이미 $$y(x) = y_h(x) + y_p(x)$$임을 알고 있다.  
여기가 조금 골때리는게 저 식이 어떻게해서 증명되는건지를 모르겠어서 자세히 말을 못하겠다.  
그래도 우리는 **선형**미분방정식의 해공간은 기저해들의 span인 것도 알고 있으니 이걸 엮어보면 제차의 해와 비제차의 특수해가 linearly independent하다는 걸 유추할 수가 있다. 이정도면 충분하겠지?  

$$y_h = c_1y_1 + c_2y_2$$인데, 이거랑 linearly independent하려면, $$y_p = u(x)y_1(x) + v(x)y_2(x)$$이어야 하고 이건 비제차 미방의 특수해이기도 하니 그대로 대입해서 풀어보면 된다. 그 과정은 유튜브에 치면 잘 나오는데, 내가 본 영상은 이거다.  

<iframe width="560" height="315" src="https://www.youtube.com/embed/BaK4Mkn1k1Y" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

이 아저씨가 마지막에 연립방정식만 던져주고 촬영을 마쳤는데, 그 연립방정식을 Cramer법칙으로 풀면 다음과 같다고 한다.  

$$u = -\int_{}{}\frac{y_2r}{W}dx, v = \int_{}{}\frac{y_1r}{W}dx$$  

여기서 또, 우리 용사님들은 제설작업 뛸 때 도끼로 얼음을 깨며 동시에 선형대수학 개념까지 산산조각내버렸기 때문에 cramer법칙이 뭔지 모를 것이다. 이전 포스팅에서 "Essence of Linear Algebra"라는 유튜브 재생목록 중 6강까지 들으라고 했었는데 이번에는 12강까지 듣고 오면 된다. cramer법칙 자체가 중요한 것은 아니니까 일단 나중으로 미뤄두어도 괜찮다.  

아무튼 저 u와 v를 구했으니 대입하면,  
$$y_p(x) = -y_1\int_{}{}\frac{y_2r}{W}dx + y_2\int_{}{}\frac{y_1r}{W}dx$$  
이고, 제차의 해와 선형결합시키면 비제차의 일반해가 된다.  
이 방식이 엄청 더럽고 치사하고 힘들기는 한데 한번이라도 공부를 했더라면 풀 수는 있기 때문에 시험문제에서 놀랍게도 중하정도의 난이도 문제로 출제된다. 그럼 도대체 고난이도 문제는 얼마나 어려울까, 어땠더라? 2년전이라 기억이 잘 안나네  

끝